/*****************************************************************************
root [1] EventTree->Print()
******************************************************************************
*Tree    :EventTree : EventTree                                              *
*Entries :   548909 : Total =     51553288207 bytes  File  Size = 17631306390 *
*        :          : Tree compression factor =   2.92                       *
******************************************************************************
*Br    0 :event     : event/I                                                *
*Entries :   548909 : Total  Size=    2252589 bytes  File Size  =     842083 *
*Baskets :      584 : Basket Size=       8442 bytes  Compression=   2.66     *
*............................................................................*
*Br    1 :INTT_BCO  : INTT_BCO/g                                             *
*Entries :   548909 : Total  Size=    4449997 bytes  File Size  =    2197438 *
*Baskets :      584 : Basket Size=       8442 bytes  Compression=   2.02     *
*............................................................................*
*Br    2 :NTrkrhits : NTrkrhits/I                                            *
*Entries :   548909 : Total  Size=    2254941 bytes  File Size  =    1387119 *
*Baskets :      584 : Basket Size=       8442 bytes  Compression=   1.62     *
*............................................................................*
*Br    3 :TrkrHitRow : vector<unsigned short>                                *
*Entries :548909 : Total  Size= 3444664141 bytes  File Size  = 1454025430 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   2.37     *
*............................................................................*
*Br    4 :TrkrHitColumn : vector<unsigned short>                             *
*Entries :548909 : Total  Size= 3444667657 bytes  File Size  = 504510152 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   6.83     *
*............................................................................*
*Br    5 :TrkrHitLadderZId : vector<unsigned char>                           *
*Entries :   548909 : Total  Size= 1726178242 bytes  File Size  =   40833906 *
*Baskets :      585 : Basket Size=    4229120 bytes  Compression=  42.27     *
*............................................................................*
*Br    6 :TrkrHitLadderPhiId : vector<unsigned char>                         *
*Entries :   548909 : Total  Size= 1726179420 bytes  File Size  =  200833362 *
*Baskets :      585 : Basket Size=    4229120 bytes  Compression=   8.60     *
*............................................................................*
*Br    7 :TrkrHitLayer : vector<unsigned char>                               *
*Entries :   548909 : Total  Size= 1726175886 bytes  File Size  =   22822290 *
*Baskets :      585 : Basket Size=    4229120 bytes  Compression=  75.63     *
*............................................................................*
*Br    8 :TrkrHitADC : vector<unsigned short>                                *
*Entries :548909 : Total  Size= 3444664141 bytes  File Size  = 924836800 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   3.72     *
*............................................................................*
*Br    9 :NClus_Layer1 : NClus_Layer1/I                                      *
*Entries :   548909 : Total  Size=    2256705 bytes  File Size  =    1252287 *
*Baskets :      584 : Basket Size=       8442 bytes  Compression=   1.79     *
*............................................................................*
*Br   10 :NClus     : NClus/I                                                *
*Entries :   548909 : Total  Size=    2252589 bytes  File Size  =    1310354 *
*Baskets :      584 : Basket Size=       8442 bytes  Compression=   1.71     *
*............................................................................*
*Br   11 :ClusLayer : vector<int>                                            *
*Entries :548909 : Total  Size= 2881234959 bytes  File Size  = 32116864 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=  89.71     *
*............................................................................*
*Br   12 :ClusX     : vector<float>                                          *
*Entries :548909 : Total  Size= 2881230271 bytes  File Size  = 2377461198 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   1.21     *
*............................................................................*
*Br   13 :ClusY     : vector<float>                                          *
*Entries :548909 : Total  Size= 2881230271 bytes  File Size  = 2389255934 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   1.21     *
*............................................................................*
*Br   14 :ClusZ     : vector<float>                                          *
*Entries :548909 : Total  Size= 2881230271 bytes  File Size  = 500027872 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   5.76     *
*............................................................................*
*Br   15 :ClusR     : vector<float>                                          *
*Entries :548909 : Total  Size= 2881230271 bytes  File Size  = 2226949407 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   1.29     *
*............................................................................*
*Br   16 :ClusPhi   : vector<float>                                          *
*Entries :548909 : Total  Size= 2881232615 bytes  File Size  = 2398810925 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   1.20     *
*............................................................................*
*Br   17 :ClusEta   : vector<float>                                          *
*Entries :548909 : Total  Size= 2881232615 bytes  File Size  = 2585452634 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   1.11     *
*............................................................................*
*Br   18 :ClusAdc   : vector<unsigned int>                                   *
*Entries :548909 : Total  Size= 2881232615 bytes  File Size  = 891385412 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   3.23     *
*............................................................................*
*Br   19 :ClusPhiSize : vector<float>                                        *
*Entries :548909 : Total  Size= 2881237303 bytes  File Size  = 605806222 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=   4.76     *
*............................................................................*
*Br   20 :ClusZSize : vector<float>                                          *
*Entries :548909 : Total  Size= 2881234959 bytes  File Size  = 23002727 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression= 125.26     *
*............................................................................*
*Br   21 :ClusLadderZId : vector<unsigned char>                              *
*Entries :   548909 : Total  Size=  726106821 bytes  File Size  =   32141250 *
*Baskets :      585 : Basket Size=    4229120 bytes  Compression=  22.59     *
*............................................................................*
*Br   22 :ClusLadderPhiId : vector<unsigned char>                            *
*Entries :   548909 : Total  Size=  726107999 bytes  File Size  =  142648678 *
*Baskets :      585 : Basket Size=    4229120 bytes  Compression=   5.09     *
*............................................................................*
*Br   23 :ClusTrkrHitSetKey : vector<unsigned int>                           *
*Entries :548909 : Total  Size= 2881244335 bytes  File Size  = 249713319 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression=  11.54     *
*............................................................................*
*Br   24 :ClusTimeBucketId : vector<int>                                     *
*Entries :548909 : Total  Size= 2881243163 bytes  File Size  = 21281512 *
*Baskets :     1168 : Basket Size=    4229120 bytes  Compression= 135.39     *
*............................................................................*
*Br   25 :event     : event/I                                                *
*Entries :   548909 : Total  Size=    2202634 bytes  File Size  =     771020 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   2.85     *
*............................................................................*
*Br   26 :clk       : clk/s                                                  *
*Entries :   548909 : Total  Size=    1101436 bytes  File Size  =    1100443 *
*Baskets :       35 : Basket Size=      32000 bytes  Compression=   1.00     *
*............................................................................*
*Br   27 :femclk    : femclk/s                                               *
*Entries :   548909 : Total  Size=    1101553 bytes  File Size  =    1100548 *
*Baskets :       35 : Basket Size=      32000 bytes  Compression=   1.00     *
*............................................................................*
*Br   28 :is_min_bias : is_min_bias/O                                        *
*Entries :   548909 : Total  Size=     551086 bytes  File Size  =      18673 *
*Baskets :       18 : Basket Size=      32000 bytes  Compression=  29.48     *
*............................................................................*
*Br   29 :is_min_bias_wozdc : is_min_bias_wozdc/O                            *
*Entries :   548909 : Total  Size=     551218 bytes  File Size  =     122748 *
*Baskets :       18 : Basket Size=      32000 bytes  Compression=   4.48     *
*............................................................................*
*Br   30 :MBD_centrality : MBD_centrality/F                                  *
*Entries :   548909 : Total  Size=    2203291 bytes  File Size  =     908460 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   2.42     *
*............................................................................*
*Br   31 :MBD_z_vtx : MBD_z_vtx/F                                            *
*Entries :   548909 : Total  Size=    2202926 bytes  File Size  =    1553256 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   1.42     *
*............................................................................*
*Br   32 :MBD_south_npmt : MBD_south_npmt/S                                  *
*Entries :   548909 : Total  Size=    1101865 bytes  File Size  =     503402 *
*Baskets :       35 : Basket Size=      32000 bytes  Compression=   2.19     *
*............................................................................*
*Br   33 :MBD_north_npmt : MBD_north_npmt/S                                  *
*Entries :   548909 : Total  Size=    1101865 bytes  File Size  =     510834 *
*Baskets :       35 : Basket Size=      32000 bytes  Compression=   2.15     *
*............................................................................*
*Br   34 :MBD_south_charge_sum : MBD_south_charge_sum/F                      *
*Entries :   548909 : Total  Size=    2203729 bytes  File Size  =    1831254 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   1.20     *
*............................................................................*
*Br   35 :MBD_north_charge_sum : MBD_north_charge_sum/F                      *
*Entries :   548909 : Total  Size=    2203729 bytes  File Size  =    1851868 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   1.19     *
*............................................................................*
*Br   36 :MBD_charge_sum : MBD_charge_sum/F                                  *
*Entries :   548909 : Total  Size=    2203291 bytes  File Size  =    1943873 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   1.13     *
*............................................................................*
*Br   37 :MBD_charge_asymm : MBD_charge_asymm/F                              *
*Entries :   548909 : Total  Size=    2203437 bytes  File Size  =    1754408 *
*Baskets :       69 : Basket Size=      32000 bytes  Compression=   1.25     *
*............................................................................*/

#include "headers/globalDefinitions.h"
#include "headers/histogramPlotting.h"

void readTree(TTree * tree) {
    // Define the variables to hold the data
    int event0, event25, NClus;
    std::vector<float> *ClusX = nullptr;
    std::vector<float> *ClusY = nullptr;
    std::vector<float> *ClusZ = nullptr;

    // Get the branches directly by their indices
    TBranch *branch0  = (TBranch*)tree->GetListOfBranches()->At(0);
    TBranch *branch25 = (TBranch*)tree->GetListOfBranches()->At(25);
    TBranch *branch12 = (TBranch*)tree->GetListOfBranches()->At(12);
    TBranch *branch13 = (TBranch*)tree->GetListOfBranches()->At(13);
    TBranch *branch14 = (TBranch*)tree->GetListOfBranches()->At(14);
    TBranch *branch10 = (TBranch*)tree->GetListOfBranches()->At(10);

    if (!branch0 || !branch25 || !branch12) {
        std::cerr << "Error getting branches!" << std::endl;
        return;
    }

    // Set the branch addresses manually
    branch0 ->SetAddress(&event0);
    branch25->SetAddress(&event25);
    branch12->SetAddress(&ClusX);
    branch13->SetAddress(&ClusY);
    branch14->SetAddress(&ClusZ);
    branch10->SetAddress(&NClus);

    // Loop over the entries in the TTree and print the data
    Long64_t nEntries = tree->GetEntries();
    for (Long64_t i = 0; i < nEntries; ++i) {
        branch0 ->GetEntry(i);  branch25->GetEntry(i);
        branch12->GetEntry(i);  branch13->GetEntry(i);  branch14->GetEntry(i);
        branch10->GetEntry(i);

        std::cout << "Entry "   << i << ":" << std::endl;
        // std::cout << "event25: " << event25 << ", ";
        // std::cout << "ClusX size: " << ClusY->size() << std::endl;
        int size_of_X = ClusX->size();  int size_of_Y = ClusY->size();  int size_of_Z = ClusZ->size();
        if (size_of_X == 0) {
            std::cout << "Empty event at " << event0 << ", " << event25 << std::endl;
            // exit(1);
        }
        if (size_of_X != size_of_Y || size_of_X != size_of_Z || size_of_Y != size_of_Z ||
            size_of_X != NClus || size_of_Y != NClus || size_of_Z != NClus) {
            std::cout << red << "# of hit insanity at " << event0 << ", " << event25 << color_reset << std::endl;
            exit(1);
        }
    }
}

void RootFileChecker () {
    // Open the ROOT file
    TFile *file = TFile::Open("../External/Data_CombinedNtuple_Run20869_HotDead_BCO_ADC_Survey.root");
    if (!file || file->IsZombie()) {
        std::cerr << "Error opening file!" << std::endl;
        return;
    }

    // Get the TTree
    TTree *tree = (TTree*)file->Get("EventTree"); // Replace "treeName" with the actual name of your TTree
    if (!tree) {
        std::cerr << "Error getting TTree!" << std::endl;
        return;
    }
    readTree(tree);
}